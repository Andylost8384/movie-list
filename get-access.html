<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Get Access ‚Äî Infectaria</title>
  <link rel="stylesheet" href="styles.css" />
</head>
<body>

<header class="topbar">
  <div class="container">
    <div class="brand">Infectaria</div>
    <nav class="nav">
      <a href="index.html">Home</a>
      <a href="models.html">Models</a>
      <a href="videos.html?category=Hentaied">Hentaied</a>
      <a href="videos.html?category=Lesbian">Lesbian</a>
      <a href="videos.html?category=All">All Sites</a>
      <button id="searchBtn" class="icon">üîç</button>
      <a href="login.html" class="login">Login</a>
      <a href="profile.html" class="login">Account</a>
    </nav>
  </div>
</header>

<main style="padding-top:110px;">
  <section class="container auth-steps">

    <!-- Step Indicator -->
    <div class="step-indicator">
      <div class="step-dot active" data-step="1">1</div>
      <div class="step-dot" data-step="2">2</div>
      <div class="step-dot" data-step="3">3</div>
    </div>

    <!-- STATUS -->
    <p id="authStatus" class="muted" style="margin-bottom:16px;">
      Step 1 ‚Äî Create your account
    </p>

    <!-- STEP 1: ACCOUNT CREATION -->
    <div class="auth-step" id="step1">
      <h1>Step 1 ‚Äî Create your Account</h1>
      <p class="models-subtitle">
        Use your email and a password. Your account will be created instantly.
      </p>

      <form id="signupForm" class="login-form">
        <label>Email
          <input type="email" id="signupEmail" required />
        </label>

        <label>Password
          <input type="password" id="signupPassword" required />
        </label>

        <button type="submit" class="btn green">Continue to Step 2</button>
      </form>

      <p id="signupMessage" style="color:red; margin-top:10px;"></p>
    </div>

    <!-- STEP 2: PLAN -->
    <div class="auth-step hidden" id="step2">
      <h1>Step 2 ‚Äî Choose your Plan</h1>
      <p class="models-subtitle">We currently offer one simple plan.</p>

      <div class="plans-grid">
        <div class="plan-card">
          <h2>30 DAYS</h2>
          <p class="plan-sub">Streaming Only</p>

          <div class="plan-price">
            <span class="amount">$0.77</span><span class="per"> (‚Çπ69)</span>
          </div>

          <p class="plan-line"><strong>Unlimited</strong> Streaming</p>
          <p class="plan-line"><strong>No</strong> Downloads</p>

          <p class="plan-note">
            Billed in one payment of <strong>$0.77 (‚Çπ69)</strong>.
          </p>

          <button class="btn green" id="goToStep3">Choose this Plan</button>
        </div>
      </div>

      <button class="btn" id="back1">‚Üê Back to Step 1</button>
    </div>

    <!-- STEP 3: PAYMENT -->
    <div class="auth-step hidden" id="step3">
      <h1>Step 3 ‚Äî Complete your Payment</h1>
      <p class="models-subtitle">
        Pay via UPI (India) or Binance Pay (International), then confirm.
      </p>

      <div class="pay-grid">

        <!-- UPI -->
        <div class="pay-card">
          <h2>India ‚Äî Pay using UPI</h2>
          <p class="muted">Scan QR or pay to UPI ID.</p>

          <img src="https://ik.imagekit.io/uno5sox6q/WhatsApp.jpg" class="upi-qr" />

          <p class="upi-id">UPI ID: <strong>your-upi-id@upi</strong></p>
          <p class="plan-note">Amount: <strong>‚Çπ69</strong></p>
        </div>

        <!-- Binance -->
        <div class="pay-card">
          <h2>International ‚Äî Binance Pay</h2>

          <p class="muted">Send <strong>$0.77</strong> in USDT.</p>
          <p class="upi-id">Binance ID: <strong>YOUR_BINANCE_ID</strong></p>
        </div>
      </div>

      <button class="btn green" id="confirmPaidBtn">
        I've completed the payment
      </button>

      <button class="btn" id="back2">‚Üê Back to Step 2</button>

      <p id="paymentMessage" style="margin-top:12px; color:green;"></p>
    </div>

  </section>
</main>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-auth-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>
<script src="firebase-config.js"></script>

<script>
// Firebase auth
const auth = firebase.auth();
const db = firebase.database();

/* STEP SWITCHER */
function showStep(n) {
  document.querySelectorAll('.auth-step').forEach(s => s.classList.add('hidden'));
  document.getElementById("step" + n).classList.remove("hidden");

  document.querySelectorAll('.step-dot').forEach(d => d.classList.remove('active'));
  document.querySelector('.step-dot[data-step="' + n + '"]').classList.add('active');
}

/* STEP 1 ‚Äî SIGNUP */
document.getElementById("signupForm").addEventListener("submit", (e) => {
  e.preventDefault();

  const email = signupEmail.value;
  const pass = signupPassword.value;

  auth.createUserWithEmailAndPassword(email, pass)
    .then(() => {
      showStep(2);
    })
    .catch((err) => {
      if (err.code === "auth/email-already-in-use") {
        // If email exists, login instead
        auth.signInWithEmailAndPassword(email, pass)
          .then(() => showStep(2))
          .catch(() => signupMessage.textContent = "Incorrect password.");
      } else {
        signupMessage.textContent = err.message;
      }
    });
});

/* STEP 2 ‚Üí STEP 3 */
document.getElementById("goToStep3").addEventListener("click", () => {
  showStep(3);
});
document.getElementById("back1").addEventListener("click", () => showStep(1));
document.getElementById("back2").addEventListener("click", () => showStep(2));

/* STEP 3 ‚Äî PAYMENT CONFIRMATION */
document.getElementById("confirmPaidBtn").addEventListener("click", () => {

  if (!auth.currentUser) {
    alert("Login error. Try again.");
    return;
  }

  const uid = auth.currentUser.uid;

  db.ref("users/" + uid).set({
    email: auth.currentUser.email,
    premium: false, // manually you will set true after checking payment
    created: Date.now()
  });

  paymentMessage.textContent =
    "Payment confirmation sent! We will activate your premium soon.";
});
</script>

<script src="search.js"></script>
<script src="script.js"></script>
</body>
</html>
